steps:
  STG_LINEITEM_ORDERS_DIM_LOOKUP-8934f8b5-6814-407b-a67a-987b215875db:
    operation:
      config:
        insertStrategy: INSERT
        postSQL: ""
        preSQL: ""
        testsEnabled: true
        truncateBefore: true
      database: ""
      deployEnabled: true
      description: ""
      isMultisource: false
      locationName: WORK
      materializationType: table
      metadata:
        appliedNodeTests: []
        columns:
          - columnReference:
              columnCounter: 15902a2f-db3f-40bc-bb1e-d8d880c4b890
              stepCounter: 8934f8b5-6814-407b-a67a-987b215875db
            dataType: NUMBER
            description: ""
            name: DIM_CUSTOMER_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 55539cf0-2760-4c23-882f-5d04aa934e89
                    stepCounter: 0f626398-2c35-4469-a588-976a4f26f6db
                transform: ""
          - columnReference:
              columnCounter: 7d3c197d-0f2f-462a-bb62-08cc7068f0a5
              stepCounter: 8934f8b5-6814-407b-a67a-987b215875db
            dataType: NUMBER
            description: ""
            name: DIM_PART_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 331fc2a1-8cf4-4646-8187-ebb03182e4f6
                    stepCounter: 8eddfc93-e91f-44d1-92d4-8eba2358d910
                transform: ""
          - columnReference:
              columnCounter: 2cf45f4f-a06c-45e7-9430-f1da1746b28b
              stepCounter: 8934f8b5-6814-407b-a67a-987b215875db
            dataType: NUMBER
            description: ""
            name: DIM_SUPPLIER_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 7b616749-075c-4592-af34-f1ce81cbe051
                    stepCounter: c53ddce5-cda9-4c45-ba22-a259079e2c1a
                transform: ""
          - columnReference:
              columnCounter: 18591dbf-f448-4667-8a6c-a6ed78b154c4
              stepCounter: 8934f8b5-6814-407b-a67a-987b215875db
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_CUSTKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 3ba99ced-3d7e-4606-a532-bc458c7c7352
                    stepCounter: d1dfa466-4f79-4b3b-8311-c06133c39621
                transform: ""
          - columnReference:
              columnCounter: 784e9e9a-51b4-4cf1-8f02-1799bd9bf7d2
              stepCounter: 8934f8b5-6814-407b-a67a-987b215875db
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SUPPKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 11719c4c-62fa-420f-a208-85308c64cbbe
                    stepCounter: d1dfa466-4f79-4b3b-8311-c06133c39621
                transform: ""
          - columnReference:
              columnCounter: 4e25e0ae-5f50-4262-af89-4b96b110ed48
              stepCounter: 8934f8b5-6814-407b-a67a-987b215875db
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_PARTKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 6cde134c-65e9-4982-907e-7852f192338c
                    stepCounter: d1dfa466-4f79-4b3b-8311-c06133c39621
                transform: ""
          - columnReference:
              columnCounter: c3dbc8e9-1df3-4b8a-b612-b15935a2acf4
              stepCounter: 8934f8b5-6814-407b-a67a-987b215875db
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_ORDERKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 51ed4aab-2889-4273-8282-95beb35040fe
                    stepCounter: d1dfa466-4f79-4b3b-8311-c06133c39621
                transform: ""
          - columnReference:
              columnCounter: 616762c8-c17c-4518-a921-71d5d0c15d24
              stepCounter: 8934f8b5-6814-407b-a67a-987b215875db
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_LINENUMBER
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: da6a5574-c116-40dd-ad4e-bf77894ca63f
                    stepCounter: d1dfa466-4f79-4b3b-8311-c06133c39621
                transform: ""
          - columnReference:
              columnCounter: e325cf82-9dc4-4677-9a8c-8ae9922eb27a
              stepCounter: 8934f8b5-6814-407b-a67a-987b215875db
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_QUANTITY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 73a3111f-e991-406d-971f-eecce75609a5
                    stepCounter: d1dfa466-4f79-4b3b-8311-c06133c39621
                transform: ""
          - columnReference:
              columnCounter: e1668fe5-7baa-4db1-98df-da96fc675ce0
              stepCounter: 8934f8b5-6814-407b-a67a-987b215875db
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_EXTENDEDPRICE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 7617fe30-7053-45e4-b5b6-39592e4386ba
                    stepCounter: d1dfa466-4f79-4b3b-8311-c06133c39621
                transform: ""
          - columnReference:
              columnCounter: f2d2ddac-afc3-4744-b55b-722e5d1e6fda
              stepCounter: 8934f8b5-6814-407b-a67a-987b215875db
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_DISCOUNT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 468233ab-6b79-4b97-9f23-02ccc138f897
                    stepCounter: d1dfa466-4f79-4b3b-8311-c06133c39621
                transform: ""
          - columnReference:
              columnCounter: d9771b7d-824b-40ff-b9f3-b540568de22d
              stepCounter: 8934f8b5-6814-407b-a67a-987b215875db
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_TAX
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 0f0a21bc-defe-4437-8e89-93462b5264a7
                    stepCounter: d1dfa466-4f79-4b3b-8311-c06133c39621
                transform: ""
          - columnReference:
              columnCounter: 9c51d392-521f-4dab-9a28-d15f0f064996
              stepCounter: 8934f8b5-6814-407b-a67a-987b215875db
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_RETURNFLAG
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: eb9e78e2-dc99-49c5-8194-c81131ff58e4
                    stepCounter: d1dfa466-4f79-4b3b-8311-c06133c39621
                transform: ""
          - columnReference:
              columnCounter: a4eff7d5-b876-4d5a-af59-9f293bcad096
              stepCounter: 8934f8b5-6814-407b-a67a-987b215875db
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_LINESTATUS
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 7ea96c69-5818-40cc-bfa8-a5d3b7377771
                    stepCounter: d1dfa466-4f79-4b3b-8311-c06133c39621
                transform: ""
          - columnReference:
              columnCounter: dd212686-3ad2-4de4-8203-755872a7152a
              stepCounter: 8934f8b5-6814-407b-a67a-987b215875db
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SHIPDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: dbfa9070-6b9b-4d1f-8a68-1d137a03e4d0
                    stepCounter: d1dfa466-4f79-4b3b-8311-c06133c39621
                transform: ""
          - columnReference:
              columnCounter: e8e86858-902b-4d53-9615-0ea464d2010a
              stepCounter: 8934f8b5-6814-407b-a67a-987b215875db
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_COMMITDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 811f8194-caf6-4163-b18d-22f8d88f0e31
                    stepCounter: d1dfa466-4f79-4b3b-8311-c06133c39621
                transform: ""
          - columnReference:
              columnCounter: f1d4e2af-2c7c-45b1-a0de-41ca1f5cd8eb
              stepCounter: 8934f8b5-6814-407b-a67a-987b215875db
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_RECEIPTDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: c58140a6-f391-4a40-9cf0-7152e3076251
                    stepCounter: d1dfa466-4f79-4b3b-8311-c06133c39621
                transform: ""
          - columnReference:
              columnCounter: 8999db3f-c0e9-43bd-9529-5ba6bcefa1b2
              stepCounter: 8934f8b5-6814-407b-a67a-987b215875db
            dataType: VARCHAR(25)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SHIPINSTRUCT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: d0e7b65b-098d-4f97-a0d5-d2c849cc8794
                    stepCounter: d1dfa466-4f79-4b3b-8311-c06133c39621
                transform: ""
          - columnReference:
              columnCounter: 57fbc615-2b38-4345-bb86-e5b1f678a8ff
              stepCounter: 8934f8b5-6814-407b-a67a-987b215875db
            dataType: VARCHAR(10)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SHIPMODE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: a22a7b5c-1509-4ec2-aa5d-66648e29d314
                    stepCounter: d1dfa466-4f79-4b3b-8311-c06133c39621
                transform: ""
          - columnReference:
              columnCounter: 0a94d64b-7456-4d01-8503-c790bbdfdc07
              stepCounter: 8934f8b5-6814-407b-a67a-987b215875db
            dataType: VARCHAR(44)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_COMMENT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: a1e76c2a-8e53-43f6-bd36-ecea2b03c0b1
                    stepCounter: d1dfa466-4f79-4b3b-8311-c06133c39621
                transform: ""
          - columnReference:
              columnCounter: 9bc037f6-27d5-499a-b555-ce6b47fd1c06
              stepCounter: 8934f8b5-6814-407b-a67a-987b215875db
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: f4e28314-d8a4-4f49-a878-755c878ce4ab
                    stepCounter: d1dfa466-4f79-4b3b-8311-c06133c39621
                transform: ""
          - columnReference:
              columnCounter: b66cbe5e-4461-4591-b96a-3f8e07cd64f1
              stepCounter: 8934f8b5-6814-407b-a67a-987b215875db
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERSTATUS
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: a56d2e23-1821-459c-8fe8-0bf509f0633a
                    stepCounter: d1dfa466-4f79-4b3b-8311-c06133c39621
                transform: ""
          - columnReference:
              columnCounter: a15217e9-d56f-4fb1-aa39-45dc3089e29c
              stepCounter: 8934f8b5-6814-407b-a67a-987b215875db
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_TOTALPRICE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: e1b664ca-c9a8-4f5a-9d0f-353f35052ecc
                    stepCounter: d1dfa466-4f79-4b3b-8311-c06133c39621
                transform: ""
          - columnReference:
              columnCounter: 21dd3a38-d992-4e83-a8ac-5f5c103c987f
              stepCounter: 8934f8b5-6814-407b-a67a-987b215875db
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 88aa1cc8-56a0-47f2-8327-4d7ef568d9b7
                    stepCounter: d1dfa466-4f79-4b3b-8311-c06133c39621
                transform: ""
          - columnReference:
              columnCounter: a4383871-1cd9-4752-b0ec-06dd1fe2b37c
              stepCounter: 8934f8b5-6814-407b-a67a-987b215875db
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERPRIORITY_NUM
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ed329dfc-9949-4c9b-9e5e-d19de222f2b3
                    stepCounter: d1dfa466-4f79-4b3b-8311-c06133c39621
                transform: ""
          - columnReference:
              columnCounter: 547049c5-096a-44a6-8f33-aade31dcd56e
              stepCounter: 8934f8b5-6814-407b-a67a-987b215875db
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERPRIORITY_DESC
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: d3bdb427-9265-4425-849c-ef7df1832ffe
                    stepCounter: d1dfa466-4f79-4b3b-8311-c06133c39621
                transform: ""
          - columnReference:
              columnCounter: 544e660a-c0c3-4eb8-b351-b54a1fb1dd48
              stepCounter: 8934f8b5-6814-407b-a67a-987b215875db
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_CLERK
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 45c20a3a-9493-4625-bbf2-5606c79dad76
                    stepCounter: d1dfa466-4f79-4b3b-8311-c06133c39621
                transform: ""
          - columnReference:
              columnCounter: 1399057f-ec05-4b54-aad3-93cd3d1d2392
              stepCounter: 8934f8b5-6814-407b-a67a-987b215875db
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_SHIPPRIORITY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 04c3d99d-929c-4ee2-acf9-a18c26f66c50
                    stepCounter: d1dfa466-4f79-4b3b-8311-c06133c39621
                transform: ""
          - columnReference:
              columnCounter: c8209868-41a9-4d08-88df-54b04adda17e
              stepCounter: 8934f8b5-6814-407b-a67a-987b215875db
            dataType: VARCHAR(79)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_COMMENT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 7d5f19ea-48e0-4cb0-8a40-1a885a38d1a5
                    stepCounter: d1dfa466-4f79-4b3b-8311-c06133c39621
                transform: ""
          - columnReference:
              columnCounter: cd8e9c84-aa5c-4b45-8779-63763d1a1865
              stepCounter: 8934f8b5-6814-407b-a67a-987b215875db
            dataType: NUMBER
            description: ""
            hashColumns: []
            hashDetails: null
            name: DAYS TO SHIP
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 51e37702-2925-4438-b508-b8af310c396a
                    stepCounter: d1dfa466-4f79-4b3b-8311-c06133c39621
                transform: ""
          - acceptedValues:
              strictMatch: false
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 54f1b15b-cc78-40e1-830e-76ac99cd41f3
              stepCounter: 8934f8b5-6814-407b-a67a-987b215875db
            dataType: NUMBER(12,2)
            description: ""
            name: PS_SUPPLYCOST
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: e47561fb-0c6f-4fea-b332-3773ddf5063a
                    stepCounter: d1dfa466-4f79-4b3b-8311-c06133c39621
                transform: ""
          - acceptedValues:
              strictMatch: false
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 0d8398b1-840b-4177-9283-301ee78e1de7
              stepCounter: 8934f8b5-6814-407b-a67a-987b215875db
            dataType: NUMBER(38,0)
            description: ""
            name: PS_AVAILQTY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: b86c72bd-3ad3-47bf-ada6-dbd161edb4ab
                    stepCounter: d1dfa466-4f79-4b3b-8311-c06133c39621
                transform: ""
        cteString: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - aliases:
              DIM_CUSTOMER: 0f626398-2c35-4469-a588-976a4f26f6db
              DIM_PART: 8eddfc93-e91f-44d1-92d4-8eba2358d910
              DIM_SUPPLIER: c53ddce5-cda9-4c45-ba22-a259079e2c1a
              STG_LINEITEM_ORDERS: d1dfa466-4f79-4b3b-8311-c06133c39621
              STG_PARTSUPP: 980886be-7b33-4c6e-92dd-06829e31f7dc
            customSQL:
              customSQL: ""
            dependencies:
              - locationName: WORK
                nodeName: DIM_CUSTOMER
              - locationName: WORK
                nodeName: DIM_PART
              - locationName: WORK
                nodeName: DIM_SUPPLIER
              - locationName: WORK
                nodeName: STG_LINEITEM_ORDERS
              - locationName: WORK
                nodeName: STG_PARTSUPP
            join:
              joinCondition: |-
                FROM {{ ref('WORK', 'STG_LINEITEM_ORDERS') }} "STG_LINEITEM_ORDERS"
                
                LEFT JOIN {{ ref('WORK', 'DIM_CUSTOMER') }} "DIM_CUSTOMER"
                
                ON "STG_LINEITEM_ORDERS"."O_CUSTKEY" = "DIM_CUSTOMER"."C_CUSTKEY"
                
                AND "STG_LINEITEM_ORDERS"."O_ORDERDATE" BETWEEN "DIM_CUSTOMER"."SYSTEM_START_DATE" AND "DIM_CUSTOMER"."SYSTEM_END_DATE"
                
                /* The dimension lookup will not yield any matches due to a lack of historical data in the customer dimension. */
                
                LEFT JOIN {{ ref('WORK', 'DIM_PART') }} "DIM_PART"
                
                ON "STG_LINEITEM_ORDERS"."L_PARTKEY" = "DIM_PART"."P_PARTKEY"
                
                LEFT JOIN {{ ref('WORK', 'DIM_SUPPLIER') }} "DIM_SUPPLIER"
                
                ON "STG_LINEITEM_ORDERS"."L_SUPPKEY" = "DIM_SUPPLIER"."S_SUPPKEY"
                
                LEFT JOIN {{ ref('WORK', 'STG_PARTSUPP') }} "STG_PARTSUPP"
                
                ON "STG_LINEITEM_ORDERS"."L_PARTKEY" = "STG_PARTSUPP"."PS_PARTKEY" AND
                
                "STG_LINEITEM_ORDERS"."L_SUPPKEY" = "STG_PARTSUPP"."PS_SUPPKEY"
            name: STG_LINEITEM_ORDERS_DIM_LOOKUP
            noLinkRefs: []
      name: STG_LINEITEM_ORDERS_DIM_LOOKUP
      overrideSQL: false
      schema: ""
      sqlType: Stage
      type: sql
    stepCounter: 8934f8b5-6814-407b-a67a-987b215875db
